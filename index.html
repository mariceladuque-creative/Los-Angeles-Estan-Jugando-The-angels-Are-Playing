<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Los Ãngeles EstÃ¡n Jugando</title>

  <!-- Manifest PWA -->
  <link rel="manifest" href="manifest.json" />
  <meta name="theme-color" content="#2f6f73" />

  <!-- Fuentes -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link
    href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;600;800&family=Nunito:wght@400;600;800&display=swap"
    rel="stylesheet"
  />

  <!-- CSS -->
  <link rel="stylesheet" href="styles/estilos.css" />
</head>

<body>
  <!-- âœ… PORTADA -->
  <section class="cover" id="cover">
    <div class="cover-card">
      <h1 class="cover-title">
        Los Ãngeles EstÃ¡n Jugando <br />
        <span class="cover-title-en">The Angels Are Playing</span>
      </h1>

      <p class="cover-subtitle">
        Cuentos infantiles <br />
        <span class="cover-subtitle-en">Childrenâ€™s stories</span>
      </p>

      <p class="cover-author">Por: Maricela Duque</p>
      <p class="cover-credits">Ilustraciones: creadas con ayuda de IA a partir de fotografÃ­as de la autora.</p>

      <div class="cover-image">
        <img
          src="images/page1.jpg"
          alt="IlustraciÃ³n de portada del cuento Los Ãngeles EstÃ¡n Jugando"
        />
      </div>

      <div class="cover-actions">
        <button id="btn-start" type="button" class="cover-button">ğŸ“– Empezar a leer</button>
        <button id="btn-reset" type="button" class="cover-button">ğŸ”„ Reiniciar</button>
        <button id="btn-cover-audio-es" type="button" class="cover-button">ğŸ”Š TÃ­tulo en EspaÃ±ol</button>
        <button id="btn-cover-audio-en" type="button" class="cover-button">ğŸ”Š Title in English</button>
      </div>

      <p id="reset-msg" class="reset-msg" aria-live="polite"></p>
    </div>

    <!-- âœ… Audios portada -->
    <audio id="cover-audio-es" src="sounds/cover_es.mp3" preload="auto"></audio>
    <audio id="cover-audio-en" src="sounds/cover_en.mp3" preload="auto"></audio>
  </section>

  <!-- âœ… LIBRO (empieza oculto) -->
  <div class="book hidden" id="book">
    <h1>Los Ãngeles EstÃ¡n Jugando</h1>
    <h2>Cuentos infantiles</h2>

    <div class="page">
      <div class="image-box">
        <img id="imagen-pagina" src="images/page1.jpg" alt="Imagen del cuento" />
      </div>

      <div class="text-box">
        <h3 id="titulo-pagina">PÃ¡gina 1</h3>

        <div class="texto-bilingue">
          <p id="texto-en">Cargando...</p>
          <hr />
          <p id="texto-es"></p>
        </div>
      </div>
    </div>

    <p id="page-indicator">PÃ¡gina 1</p>

    <div class="lang-toggle">
      <button id="btn-both" type="button">ğŸŒ EN + ES</button>
      <button id="btn-en" type="button">ğŸ‡ºğŸ‡¸ EN</button>
      <button id="btn-es" type="button">ğŸ‡ªğŸ‡¸ ES</button>
    </div>

    <div class="buttons">
      <button id="btn-prev" type="button">â¬… PÃ¡gina anterior</button>
      <button id="btn-next" type="button">PÃ¡gina siguiente â¡</button>
      <button id="btn-fullscreen" type="button">â›¶ Pantalla completa</button>
      <button id="btn-theme" type="button">ğŸŒ™ Modo oscuro</button>
      <button id="btn-audio" type="button">ğŸ”Š Audio</button>
      <button id="btn-music" type="button">ğŸµ MÃºsica</button>
    </div>
  </div>

  <!-- âœ… CRÃ‰DITOS -->
  <footer class="credits">
    <p><strong>Autora:</strong> Maricela Duque</p>
    <p><strong>Ilustraciones:</strong> creadas con ayuda de IA a partir de fotografÃ­as de la autora.</p>
    <p class="copyright">Â© 2026 Maricela Duque. Todos los derechos reservados.</p>
    <p><strong>MÃºsica de fondo:</strong> â€œFiesta Divertidaâ€ â€“ FiftySounds</p>
<p>
  MÃºsica de:
  <a href="https://www.fiftysounds.com/es/musica-libre-de-derechos/fiesta-divertida.html" target="_blank" rel="noopener noreferrer">
    FiftySounds â€“ Fiesta Divertida
  </a>
</p>
  </footer>

  <!-- âœ… Sonido de pasar pÃ¡gina -->
  <audio id="page-sound" src="sounds/page.mp3" preload="auto"></audio>

  <!-- âœ… MÃºsica de fondo -->
  <audio id="bg-music" src="sounds/funny-party.mp3" preload="auto" loop></audio>

  <!-- âœ… JS del cuento (SOLO UNA VEZ) -->
  <script src="stories/cuento1.js"></script>

  <!-- âœ… JS de la portada (SOLO UNA VEZ) -->
<script>
  (function () {
    const cover = document.getElementById("cover");
    const book = document.getElementById("book");

    const btnStart = document.getElementById("btn-start");
    const btnReset = document.getElementById("btn-reset");

    const bgMusic = document.getElementById("bg-music");
    const resetMsg = document.getElementById("reset-msg");

    // Audios de portada
    const btnCoverEs = document.getElementById("btn-cover-audio-es");
    const btnCoverEn = document.getElementById("btn-cover-audio-en");
    const coverAudioEs = document.getElementById("cover-audio-es");
    const coverAudioEn = document.getElementById("cover-audio-en");

    function actualizarTextoStart() {
      const savedPage = localStorage.getItem("paginaActual");
      const n = savedPage === null ? 0 : parseInt(savedPage, 10);
      btnStart.textContent = n > 0 ? "ğŸ“– Continuar leyendo" : "ğŸ“– Empezar a leer";
    }

    function dispatchOpenBook() {
      // Compatibilidad con cuento1.js (si escucha este evento)
      window.dispatchEvent(new Event("openBook"));
    }

    function dispatchCloseBook() {
      window.dispatchEvent(new Event("closeBook"));
    }

    function detenerAudiosPortada() {
      if (coverAudioEs) { coverAudioEs.pause(); coverAudioEs.currentTime = 0; }
      if (coverAudioEn) { coverAudioEn.pause(); coverAudioEn.currentTime = 0; }
    }

    // volumen suave
    if (bgMusic) bgMusic.volume = 0.12;

    // Texto inicial correcto
    actualizarTextoStart();

  // Abrir libro
btnStart.addEventListener("click", () => {
  cover.classList.add("hidden");
  book.classList.remove("hidden");
  window.scrollTo({ top: 0, behavior: "smooth" });

  detenerAudiosPortada();

  // âœ… SIEMPRE encender mÃºsica al abrir (ANTES del evento)
  localStorage.setItem("bgMusic", "on");

  // avisar al cuento
  dispatchOpenBook();

  // âœ… iniciar mÃºsica desde el click
  if (window.startMusic) window.startMusic();
});

    // Volver a portada (para cuento1.js)
    function volverAPortada() {
      book.classList.add("hidden");
      cover.classList.remove("hidden");
      window.scrollTo({ top: 0, behavior: "smooth" });

      if (bgMusic) {
        bgMusic.pause();
        bgMusic.currentTime = 0;
      }

      // avisar cierre (si lo quieres manejar en cuento1.js)
      dispatchCloseBook();

      // recalcula el texto del botÃ³n
      actualizarTextoStart();
    }
    window.volverAPortada = volverAPortada;

    // âœ… Reiniciar progreso
    if (btnReset) {
      btnReset.addEventListener("click", () => {
        // Forzar inicio
        localStorage.setItem("paginaActual", "0");
        localStorage.setItem("modoIdioma", "both");

        // detener mÃºsica
        if (bgMusic) {
          bgMusic.pause();
          bgMusic.currentTime = 0;
        }

        // detener audios de portada
        detenerAudiosPortada();

        // UI inmediata
        btnStart.textContent = "ğŸ“– Empezar a leer";

        if (resetMsg) {
          resetMsg.textContent = "âœ… Progreso reiniciado. Puedes empezar desde el inicio.";
          setTimeout(() => (resetMsg.textContent = ""), 2500);
        }

        // volver a portada (aunque ya estÃ©s en portada no pasa nada)
        volverAPortada();
      });
    }

    // âœ… Audio portada ES/EN
    if (btnCoverEs && coverAudioEs) {
      btnCoverEs.addEventListener("click", () => {
        if (!coverAudioEs.paused) {
          coverAudioEs.pause();
          coverAudioEs.currentTime = 0;
          return;
        }
        if (coverAudioEn) { coverAudioEn.pause(); coverAudioEn.currentTime = 0; }
        coverAudioEs.currentTime = 0;
        coverAudioEs.play().catch(() => {});
      });
    }

    if (btnCoverEn && coverAudioEn) {
      btnCoverEn.addEventListener("click", () => {
        if (!coverAudioEn.paused) {
          coverAudioEn.pause();
          coverAudioEn.currentTime = 0;
          return;
        }
        if (coverAudioEs) { coverAudioEs.pause(); coverAudioEs.currentTime = 0; }
        coverAudioEn.currentTime = 0;
        coverAudioEn.play().catch(() => {});
      });
    }
  })();
</script>
</body>
</html>

